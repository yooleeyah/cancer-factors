# Анализ факторов, связанных с риском развития рака шейки матки

## Обзор
В данном проекте проведен глубокий анализ медицинских данных с применением различных алгоритмов машинного обучения для определения наиболее значимых признаков, коррелирующих с риском рака шейки матки. В рамках данного проекта особое внимание уделяется интерпретируемости моделей и выявлению потенциальных факторов риска. Проект демонстрирует потенциал применения машинного обучения для ранней диагностики и выявления ключевых факторов риска развития заболеваний.

## Проблема
Рак шейки матки остается серьезной глобальной проблемой здравоохранения, требующей постоянного совершенствования методов ранней диагностики и профилактики. Несмотря на достижения в медицине, точное и своевременное выявление индивидуальных факторов риска, влияющих на развитие заболевания, остается сложной задачей. Анализ больших объемов медицинских данных помогает выявить новые закономерности, но требует применения продвинутых аналитических методов. Данный проект направлен на изучение потенциала машинного обучения и методов анализа важности признаков для выявления и интерпретации ключевых демографических, анамнестических и лабораторных показателей, связанных с риском развития рака шейки матки.

## Данные
Данный проект основан на наборе данных, полученном из UC Irvine Machine Learning Repository.

Источник: [UCI Machine Learning Repository - Cervical Cancer (Risk Factors) Data Set](https://archive.ics.uci.edu/ml/datasets/Cervical+Cancer+%28Risk+Factors%29)

Данные были собраны в Университетском госпитале Каракаса (Hospital Universitario de Caracas, Венесуэла), и содержат информацию о демографических характеристиках, привычках (курение, гормональные контрацептивы) и исторических медицинских записях пациенток, включая результаты различных диагностических тестов (Hinselmann, Schiller, Cytology, Biopsy).

Набор данных включает 36 признаков, охватывающих несколько категорий:
*   Демографические данные: возраст, количество беременностей, количество половых партнеров.
*   Привычки и анамнез: курение (стаж курения, количество пачек в год), использование гормональных контрацептивов (продолжительность использования).
*   Медицинские данные: количество диагнозов ЗППП, ВИЧ, генитальных папиллом, результаты различных обследований (Hinselmann, Schiller, Cytology, Biopsy) и другие показатели.

## Цель проекта
Основная цель данного проекта — определить наиболее значимые факторы риска, влияющие на развитие рака шейки матки, используя методы машинного обучения. В рамках проекта были реализованы следующие этапы:
* Проведение глубокого исследовательского анализа данных (EDA) для изучения данных, выявления аномалий и взаимосвязей между признаками.
* Очистка данных, обработка пропусков и выбросов, а также feature engineering и отбор наиболее информативных признаков для построения модели.
* Применение различных алгоритмов машинного обучения (логистическая регрессия, RandomForest, LightGBM) для оценки важности признаков.

## Используемые технологии
*   **Язык программирования:** Python
*   **Библиотеки:** Pandas, NumPy, Scikit-learn, LightGBM, Matplotlib, Seaborn
*   **Среда разработки:** Google Colaboratory (Colab)

## Методология
В ходе работы над проектом были выполнены следующие ключевые этапы:

1. **Загрузка и обзор данных:**
    *   Осуществлен импорт исходных данных из CSV-файла.
    *   Проведен первичный обзор структуры данных, типов признаков и наличия пропусков.

2. **Исследовательский анализ данных (EDA):**
    *   Проведен анализ распределения признаков и их взаимосвязей, а также анализ выбросов.
    *   Использованы визуализации для выявления основных закономерностей, аномалий и потенциальных наблюдений, связанных с целевой переменной.

3. **Обработка данных и Feature engineering:**
    *   Проведена тщательная подготовка данных к анализу и моделированию, включая обработку пропусков.
    *   Заполнение пропусков: отсутствующие значения были заполнены медианой на основе корреляции признаков с целью сохранения максимального объема данных и предотвращения ошибок в моделях.
    *   Приведение типов данных: обеспечено корректное преобразование типов всех признаков для их правильной обработки и использования в алгоритмах машинного обучения.
    *   Feature engineering: проведены эксперименты по созданию новых признаков из существующих для обогащения данных. В результате анализа, полезный признак был включен в финальный набор данных для моделирования.

4. **Отбор признаков и моделирование:**
    *   Для снижения размерности данных, устранения избыточности и повышения эффективности моделей был выполнен отбор признаков. Использовались методы, основанные на корреляции признаков, VarianceThreshold, SelectPercentile и просмотра важности признаков, для выделения наиболее информативных факторов.
    *   Исходные данные были разделены на обучающую и тестовую выборки для обеспечения надежной и объективной оценки производительности моделей.
    *   Для моделей, чувствительных к диапазону значений признаков, таких как логистическая регрессия, было проведено масштабирование признаков с использованием MaxAbsScaler.
    *   С помощью сравнения производительности был выбран алгоритм градиентного бустинга LightGBM, показавший лучшие результаты.
    *   Обучены отобранные модели, включая логистическую регрессию, дерево решений, RandomForest и LightGBM, с подбором гиперпараметров для каждого алгоритма.

5. **Оценка важности признаков:**
    *   На основе лучших обученных моделей была проведена оценка важности признаков.
    *   Использовались методы оценки важности признаков feature_importances_ и permutation_importance, позволяющие количественно определить вклад каждого признака в предсказание целевой переменной.
    *   Результаты этой оценки позволили ранжировать признаки по степени их влияния на риск развития рака шейки матки, выделяя наиболее информативные и критически важные факторы для дальнейшего анализа.

## Результаты и выводы
Проведенный анализ данных с применением методов машинного обучения позволил выявить ключевые признаки, которые оказывают наиболее значимое влияние на целевую переменную.

Среди наиболее важных признаков оказались:

*   Hormonal Contraceptives (years) (длительность использования гормональных контрацептивов): этот фактор подчеркивает важность анализа продолжительности применения гормональных контрацептивов.
*   STDs: Time since first diagnoses (время с момента первого диагноза ЗППП): указывает на долговременные последствия или хроническое течение инфекций, влияющие на риск развития рака.
*   STDs: Time since last diagnoses (время с момента последнего диагноза ЗППП): также является важным показателем, отражающим недавнюю активность инфекций или их рецидивы.
*   First sexual intercourse (возраст первого полового акта): отражает влияние раннего начала половой жизни на общий риск развития рака.
*   Age (возраст): является классическим демографическим фактором, который часто играет значительную роль в развитии онкологических заболеваний.

Эти выводы подчеркивают потенциал машинного обучения в выявлении сложных взаимосвязей в медицинских данных и могут служить основой для дальнейших, более глубоких медицинских исследований. Использование ML-моделей в данном контексте оказалось эффективным инструментом для количественной оценки вклада каждого признака в общую картину риска.

Таким образом, проект демонстрирует, как аналитические подходы могут помочь в более глубоком понимании эпидемиологии и факторов риска рака шейки матки, предоставляя ценные данные для профилактических мероприятий и дальнейших научных работ.

## Дальнейшие шаги и улучшения
Данный проект заложил основу для понимания потенциала применения методов машинного обучения в определении факторов риска развития заболеваний, но существует несколько направлений для его дальнейшего развития и улучшения:

*   Расширение набора данных: привлечение дополнительных данных из других источников и/или увеличение объема текущего набора данных для повышения статистической значимости и обобщающей способности выводов.
*   Использование более сложных ML-моделей: исследование потенциала других, более продвинутых алгоритмов машинного обучения (например, глубоких нейронных сетей) для выявления скрытых закономерностей.
*   Клиническая валидация: сотрудничество с медицинскими специалистами для клинической валидации выявленных факторов и оценки их практической применимости в диагностике и профилактике.
*   Разработка интерактивного инструмента: создание приложения или дашборда, позволяющего медицинским работникам вводить данные пациента и получать оценку риска заболевания, а также визуализировать вклад каждого фактора.

## Как запустить проект
Для запуска проекта следуйте следующим шагам:

1. Клонирование репозитория:
   
    Откройте терминал/командную строку и выполните:
    ```bash
    git clone https://github.com/yooleyah/cancer-factors.git
    cd cancer-factors
    ```

2. Установка зависимостей:
   
    Установите необходимые библиотеки с помощью pip:
    ```bash
    pip install pandas numpy scikit-learn==1.3.2 matplotlib seaborn lightgbm
    ```

3. Запуск Jupyter Notebook/Colab:
    *   Локально (Jupyter Notebook): из корневой директории проекта запустите `jupyter notebook`. В открывшемся интерфейсе выберите и откройте файл `Cervical_Cancer_Risk_Factors.ipynb`.
    *   В Google Colaboratory: загрузите файл `Cervical_Cancer_Risk_Factors.ipynb` в свой Google Drive и откройте его через Google Colab. Убедитесь, что все необходимые библиотеки установлены (можно выполнить команду `!pip install` в начале ноутбука, если требуется).

После открытия ноутбука последовательно выполните все ячейки для воспроизведения анализа.

## Контакты
Если у вас возникли вопросы по проекту или предложения по сотрудничеству, пожалуйста, свяжитесь со мной: 
*  Email: yuliya.khismatullina@bk.ru

Для просмотра других моих проектов:
*  GitHub: https://github.com/yooleeyah

Буду рада вашим отзывам!
